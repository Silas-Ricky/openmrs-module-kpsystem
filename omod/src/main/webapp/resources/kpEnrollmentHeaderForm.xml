<!--

    This Source Code Form is subject to the terms of the Mozilla Public License,
    v. 2.0. If a copy of the MPL was not distributed with this file, You can
    obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under
    the terms of the Healthcare Disclaimer located at http://openmrs.org/license.

    Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS
    graphic logo is a trademark of OpenMRS Inc.

-->
<htmlform formUuid="c7f47cea-207b-11e9-ab14-d663bd873d93" formName="KP Enrollment"
          formEncounterType="c7f47a56-207b-11e9-ab14-d663bd873d93" formVersion="1.0">

    <macros>
        service_area=160540
        peer_educator=165004
        peer_worker_name=1473
        regular_sex_partner=165027
        partner_name=161135
        partner_alias=165028
        partner_contact=159635
        contact-regular-sex-partner=165029

    </macros>

    <!-- Flowsheet table view -->
    <ifMode mode="VIEW" include="true">

        <table class="visit-table data-entry-table">
            <thead class="visit-table-header">
                <tr>
                    <td style="margin:2%">Enrollment Date</td>
                    <td>Client Unique No.</td>
                    <td>Enrollment Service Area</td>
                    <td>Contacted by a peer educator</td>
                    <td>Peer educator Name</td>
                    <td>Regular Sex Partner</td>
                    <td>Partner Name</td>
                    <td>Partner Alias</td>
                    <td>Partner Contact</td>
                    <td>Contact Sex Partner</td>
                </tr>

            </thead>
            <tbody class="visit-table-body">
                <tr class="visit-table-row">
                    <td class="nowrap visit-date">
                        <!-- Encounter Date -->
                        <encounterDate />
                    </td>
                          <!--Unique client no.-->
                    <td>
                        <span id="kp-id"><patient id="upn" field="identifier" identifierTypeId="b7bfefd0-239b-11e9-ab14-d663bd873d93" /></span>
                    </td>
                    <td>
                        <obs id="enrollment_area" conceptId="$service_area"/>

                    </td>
                    <td>
                        <obs id="peer-educator" conceptId="$peer_educator"
                             answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                             answerLabels="Yes,No"
                             style="dropdown" />
                    </td>

                    <td>
                        <obs id="$peer_worker_name" conceptId="$peer_worker_name"/>

                    </td>

                    <td>
                        <obs id="regular-sex-partner" conceptId="$regular_sex_partner"
                             answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                             answerLabels="Yes,No"
                             style="dropdown" />
                    </td>

                    <td>
                        <obs id="partner_name" conceptId="$partner_name"/>
                    </td>

                    <td>
                        <obs id="partner_alias" conceptId="$partner_alias"/>
                    </td>

                    <td>
                        <obs id="partner_contact" conceptId="$partner_contact"/>
                    </td>

                    <td>
                        <obs id="contact-regular-sex-partner" conceptId="$contact-regular-sex-partner"
                             answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                             answerLabels="Yes,No"
                             style="dropdown" />
                    </td>
                </tr>
            </tbody>
        </table>

    </ifMode>

    <!-- Data entry view -->
    <ifMode mode="VIEW" include="false">

        <table class="visit-table data-entry-table">
            <tr>
                <th>Visit Date</th>
                <td><encounterDate id="visitDate" size="20" default="today" /></td>
            </tr>
            <tr>
                <td>Unique Client Number</td>
                <td>
                    <span id="kp-id"><patient id="upn" field="identifier" identifierTypeId="b7bfefd0-239b-11e9-ab14-d663bd873d93" /></span>

                </td>
            </tr>
            <tr>
                <td>Enrollment Service Areas</td>
                <td>
                    <obs id="enrollment_area" conceptId="$service_area"/>
                </td>
            </tr>
            <tr>
                <td>Contacted by a peer educator</td>
                <td>
                    <obs id="peer-educator" conceptId="$peer_educator"
                         answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                         answerLabels="Yes,No"
                         style="dropdown" />
                </td>
            </tr>
            <tr>
                <td>Peer educator name</td>
                <td>
                    <obs id="$peer_worker_name" conceptId="1473"/>

                </td>
            </tr>
            <tr>
                <td>Regular Sex Partner</td>
                <td>
                    <obs id="regular-sex-partner" conceptId="$regular_sex_partner"
                         answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                         answerLabels="Yes,No"
                         style="dropdown" />
                </td>
            </tr>
            <tr>
                <td>Partner Name</td>
                <td>
                    <obs id="partner_name" conceptId="$partner_name"/>
                </td>
            </tr>
            <tr>
                <td>Partner Alias </td>
                <td>
                    <obs id="partner_alias" conceptId="$partner_alias"/>
                </td>
            </tr>
           <tr>
                <td>Partner Contact</td>
                <td>
                    <obs id="partner_contact" conceptId="$partner_contact"/>
                </td>
            </tr>
            <tr>
                <td>Contact Sex Partner</td>
                <td>
                    <obs id="contact-regular-sex-partner" conceptId="$contact-regular-sex-partner"
                         answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                         answerLabels="Yes,No"
                         style="dropdown" />
                </td>
            </tr>
        </table>

        <submit/>

    </ifMode>
    <script type="text/javascript">
        jq(function() {


        var contacted = jq("#peer-educator select").change(ContactPeer)
        var regularSexPartner = jq("#regular-sex-partner select").change(RegularSexPartner)

        //console.log("Run  ==> contacted");
        });

        function RegularSexPartner() {

        var regularSex = jq("#regular-sex-partner select").val();
        console.log(regularSex);
        if (regularSex == 1066){
        console.log("tested");
        jq('#partner_name input').prop('disabled', true);
        jq('#partner_name input').val('');
        jq('#partner_alias input').prop('disabled', true);
        jq('#partner_alias input').val('');
        jq('#partner_contact input').prop('disabled', true);
        jq('#partner_contact input').val('');
        jq('#contact-regular-sex-partner select').prop('disabled', true);
        jq('#contact-regular-sex-partner select').val('');

        }
        else{
        jq('#partner_name input').prop('disabled', false);
        jq('#partner_name input').val('');
        jq('#partner_alias input').prop('disabled', false);
        jq('#partner_alias input').val('');
        jq('#partner_contact input').prop('disabled', false);
        jq('#partner_contact input').val('');
        jq('#contact-regular-sex-partner select').prop('disabled', false);
        jq('#contact-regular-sex-partner select').val('');

        }
        }


        function ContactPeer() {

        var peer = jq("#peer-educator select").val();
        console.log(peer);
        if (peer == 1066){
        jq('#$peer_worker_name input').prop('disabled', true);

        jq('#$peer_worker_name input').val('');

        }
        else{
        jq('#$peer_worker_name input').prop('disabled', false);
        jq('#$peer_worker_name input').val('');

        }
        }
    </script>
</htmlform>